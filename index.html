<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HMD Spotify</title>
    <style>
        body { background-color: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; padding: 10px; display: flex; flex-direction: column; justify-content: center; height: 100vh; overflow: hidden; }
        #track-name { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        #artist-name { font-size: 14px; color: #1DB954; margin-bottom: 25px; }
        button { background-color: #1DB954; border: none; color: white; padding: 20px; border-radius: 50%; font-size: 24px; width: 80px; height: 80px; margin: 0 auto; cursor: pointer; }
        #status { font-size: 10px; color: #444; margin-top: 20px; }
    </style>
</head>
<body>
    <div id="track-name">Ready to Connect</div>
    <div id="artist-name">HMD 110 4G</div>
    <button id="togglePlay">▶</button>
    <div id="status">Vercel: Connecting...</div>

    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script>
        window.onSpotifyWebPlaybackSDKReady = () => {
            const player = new Spotify.Player({
                name: 'HMD 110 4G',
                getOAuthToken: async cb => {
                    try {
                        const res = await fetch('https://spotify-hmd.vercel.app/api/token');
                        const data = await res.json();
                        cb(data.access_token);
                        document.getElementById('status').innerText = "Vercel: Online";
                    } catch (e) {
                        document.getElementById('status').innerText = "Vercel: Error";
                    }
                }
            });
            player.addListener('state_changed', state => {
                if (!state) return;
                document.getElementById('track-name').innerText = state.track_window.current_track.name;
                document.getElementById('artist-name').innerText = state.track_window.current_track.artists[0].name;
                document.getElementById('togglePlay').innerText = state.paused ? "▶" : "||";
            });
            player.connect();
            document.getElementById('togglePlay').onclick = () => player.togglePlay();
        };
    </script>
</body>
</html>
